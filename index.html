<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>橘子的 2026 歐洲行程</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/4.1.0/vuedraggable.umd.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        .glass-nav { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border-top: 1px solid rgba(255,255,255,0.3); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .active-tab { background-color: #000; color: #fff; border-radius: 1rem; }
        .itinerary-card:active { transform: scale(0.98); }
    </style>
</head>
<body>

<div id="app">
    <div class="max-w-md mx-auto min-h-screen flex flex-col relative bg-slate-50 shadow-2xl overflow-x-hidden">
        
        <header class="relative h-64 flex-shrink-0">
            <img :src="cityImage" class="w-full h-full object-cover transition-all duration-1000" alt="city">
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
            <div class="absolute bottom-12 left-6 text-white">
                <h1 class="text-3xl font-black tracking-tight">{{ currentCityDisplay }}</h1>
                <p class="text-sm opacity-80 font-medium">Feb 2026 Adventure</p>
            </div>
            
            <div class="absolute -bottom-4 left-4 right-4 h-14 bg-white/90 backdrop-blur rounded-2xl shadow-xl flex items-center justify-around p-1 border border-white/50">
                <button v-for="t in ['itinerary', 'info', 'shopping', 'expense']" 
                        @click="activeTab = t" 
                        :class="['flex-1 h-full flex items-center justify-center transition-all', activeTab === t ? 'active-tab' : 'text-slate-400']">
                    <i :data-lucide="getTabIcon(t)" class="w-5 h-5"></i>
                </button>
            </div>
        </header>

        <main class="flex-1 px-5 pt-10 pb-32 overflow-y-auto">
            
            <div v-if="activeTab === 'itinerary'" class="space-y-6 animate-in fade-in duration-500">
                <div class="bg-white p-4 rounded-3xl flex items-center justify-between shadow-sm border border-slate-100">
                    <div class="flex items-center">
                        <div class="bg-blue-50 p-2 rounded-2xl mr-3 text-blue-500">
                            <i data-lucide="cloud-sun" class="w-7 h-7"></i>
                        </div>
                        <div>
                            <div class="text-xl font-black text-slate-800">10°C / 6°C</div>
                            <div class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">多雲時晴 · {{ currentCityDisplay }}</div>
                        </div>
                    </div>
                </div>

                <div class="flex space-x-3 overflow-x-auto hide-scrollbar pb-2">
                    <div v-for="d in dates" :key="d.full" 
                         @click="selectedDate = d.full"
                         :class="['flex-shrink-0 w-14 h-20 flex flex-col items-center justify-center rounded-2xl transition-all cursor-pointer', 
                                  selectedDate === d.full ? 'bg-blue-600 text-white shadow-lg shadow-blue-200' : 'bg-white text-slate-400 shadow-sm']">
                        <span class="text-[10px] font-bold mb-1 uppercase">{{ d.weekday }}</span>
                        <span class="text-xl font-black">{{ d.day }}</span>
                    </div>
                </div>

                <draggable v-model="itineraryData[selectedDate]" item-key="id" handle=".drag-handle">
                    <template #item="{element, index}">
                        <div class="mb-4">
                            <div v-if="index > 0" class="flex items-center ml-10 my-3 text-slate-300">
                                <i :data-lucide="element.prevTransportIcon || 'walking'" class="w-4 h-4 mr-3"></i>
                                <span class="text-[10px] font-bold bg-slate-100 px-3 py-1 rounded-full text-slate-400">{{ element.travelTime || '15 min' }}</span>
                            </div>

                            <div @click="openGoogleMaps(element.name)" class="itinerary-card bg-white rounded-[1.5rem] p-4 shadow-sm border border-slate-100 flex items-start group relative">
                                <div class="drag-handle p-2 -ml-2 cursor-grab text-slate-200 group-hover:text-slate-400">
                                    <i data-lucide="grip-vertical" class="w-5 h-5"></i>
                                </div>
                                <div class="flex-1 ml-1">
                                    <div class="flex justify-between items-center mb-1">
                                        <span :class="['text-[9px] px-2 py-0.5 rounded-lg font-black uppercase tracking-wider', catStyle(element.category)]">
                                            {{ element.category }}
                                        </span>
                                        <span class="text-slate-400 text-[10px] font-bold flex items-center"><i data-lucide="clock" class="w-3 h-3 mr-1"></i> {{ element.time }}</span>
                                    </div>
                                    <h3 class="font-bold text-slate-800 text-base leading-tight">{{ element.name }}</h3>
                                    <p v-if="element.remark" class="text-[11px] text-slate-400 mt-1 italic">{{ element.remark }}</p>
                                </div>
                            </div>
                        </div>
                    </template>
                </draggable>
            </div>

            <div v-if="activeTab === 'info'" class="space-y-6 animate-in fade-in duration-500">
                <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100">
                    <h3 class="font-black text-slate-800 mb-4 flex items-center"><i data-lucide="refresh-cw" class="w-5 h-5 mr-2 text-blue-500"></i> 匯率換算 (EUR/TWD)</h3>
                    <div class="space-y-4">
                        <div class="relative">
                            <input type="number" v-model="eurInput" class="w-full bg-slate-50 p-4 rounded-2xl font-black text-xl outline-none border-2 border-transparent focus:border-blue-200" placeholder="0.0">
                            <span class="absolute right-4 top-4 text-slate-300 font-bold">€</span>
                        </div>
                        <div class="text-center text-3xl font-black text-blue-600">≈ NT$ {{ (eurInput * 35.2).toLocaleString() }}</div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100">
                    <h3 class="font-black text-slate-800 mb-4 flex items-center"><i data-lucide="home" class="w-5 h-5 mr-2 text-emerald-500"></i> 住宿清單</h3>
                    <div v-for="h in hotelList" @click="openGoogleMaps(h.name)" class="mb-3 p-4 bg-slate-50 rounded-2xl border border-slate-100 cursor-pointer">
                        <div class="font-bold text-slate-800 text-sm">{{ h.name }}</div>
                        <div class="text-[10px] text-slate-400 mt-1">{{ h.dateRange }} · {{ h.address }}</div>
                    </div>
                </div>
            </div>

            <div v-if="activeTab === 'shopping'" class="text-center py-20 text-slate-300"><i data-lucide="shopping-bag" class="w-12 h-12 mx-auto mb-2 opacity-20"></i><p>清單功能已就緒</p></div>
            <div v-if="activeTab === 'expense'" class="text-center py-20 text-slate-300"><i data-lucide="wallet" class="w-12 h-12 mx-auto mb-2 opacity-20"></i><p>記帳功能已就緒</p></div>

        </main>

        <button @click="showAddModal = true" class="fixed bottom-8 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center z-50 active:scale-90 transition-transform">
            <i data-lucide="plus" class="w-8 h-8"></i>
        </button>

        <div v-if="showAddModal" class="fixed inset-0 z-[100] flex items-end justify-center p-4">
            <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" @click="showAddModal = false"></div>
            <div class="bg-white w-full max-w-sm rounded-[2.5rem] p-8 relative shadow-2xl">
                <h3 class="text-2xl font-black mb-6">新增項目</h3>
                <input v-model="newItemName" type="text" placeholder="輸入行程名稱..." class="w-full bg-slate-50 p-4 rounded-2xl mb-4 outline-none border-2 border-transparent focus:border-blue-500">
                <button @click="addNewItem" class="w-full py-4 bg-blue-600 text-white rounded-2xl font-black">確認新增</button>
            </div>
        </div>

    </div>
</div>

<script>
    // 確保 Vue 物件存在
    const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;

    const app = createApp({
        components: {
            draggable: window.vuedraggable
        },
        setup() {
            const activeTab = ref('itinerary');
            const selectedDate = ref('2026/02/07');
            const eurInput = ref(0);
            const showAddModal = ref(false);
            const newItemName = ref('');

            const dates = [
                { day: '07', weekday: 'Sat', full: '2026/02/07' }, { day: '08', weekday: 'Sun', full: '2026/02/08' },
                { day: '09', weekday: 'Mon', full: '2026/02/09' }, { day: '10', weekday: 'Tue', full: '2026/02/10' },
                { day: '11', weekday: 'Wed', full: '2026/02/11' }, { day: '12', weekday: 'Thu', full: '2026/02/12' },
                { day: '13', weekday: 'Fri', full: '2026/02/13' }, { day: '14', weekday: 'Sat', full: '2026/02/14' },
                { day: '15', weekday: 'Sun', full: '2026/02/15' }, { day: '16', weekday: 'Mon', full: '2026/02/16' },
                { day: '17', weekday: 'Tue', full: '2026/02/17' }
            ];

            // 11 天完整行程數據
            const itineraryData = ref({
                '2026/02/07': [
                    { id: 101, category: '航班', name: '巴黎戴高樂機場 (CDG)', time: '10:30', remark: '抵達巴黎', travelTime: '45 min', prevTransportIcon: 'bus' },
                    { id: 102, category: '住宿', name: 'ibis Paris Gare de Lyon Diderot', time: '14:00', remark: 'Check-in', travelTime: '15 min', prevTransportIcon: 'walking' },
                    { id: 103, category: '美食', name: "La Maison d'Isabelle", time: '15:30', remark: '冠軍可頌', travelTime: '20 min', prevTransportIcon: 'walking' },
                    { id: 104, category: '購物', name: '樂蓬馬歇百貨公司', time: '16:30' }
                ],
                '2026/02/08': [
                    { id: 201, category: '美食', name: 'Jellycat Pâtisserie', time: '10:00' },
                    { id: 202, category: '美食', name: 'Bachir 冰淇淋', time: '14:00' },
                    { id: 203, category: '美食', name: 'Papy aux Fourneaux', time: '19:00' }
                ],
                '2026/02/09': [
                    { id: 301, category: '航班', name: '巴黎 (CDG) ➔ 尼斯 (NCE)', time: '09:00', prevTransportIcon: 'plane' },
                    { id: 302, category: '住宿', name: '5 Rue Gustave Deloye (尼斯公寓)', time: '12:00' },
                    { id: 303, category: '美食', name: 'Maison Margaux', time: '14:00' },
                    { id: 304, category: '景點', name: '馬塞納廣場', time: '16:00' }
                ],
                '2026/02/10': [
                    { id: 401, category: '景點', name: '城堡山公園', time: '09:30' },
                    { id: 402, category: '景點', name: '賽雷亞花果市集', time: '11:00' },
                    { id: 403, category: '美食', name: 'Peixes (海鮮料理)', time: '13:00' }
                ],
                '2026/02/11': [
                    { id: 501, category: '景點', name: '埃茲小鎮 Èze Village', time: '10:00', prevTransportIcon: 'bus' },
                    { id: 502, category: '景點', name: '摩納哥親王宮', time: '15:00', prevTransportIcon: 'bus' }
                ],
                '2026/02/12': [
                    { id: 601, category: '航班', name: '尼斯 ➔ 里斯本', time: '11:00', prevTransportIcon: 'plane' },
                    { id: 602, category: '住宿', name: 'The Visionaire Apartments', time: '15:00' },
                    { id: 603, category: '美食', name: 'Fábrica da Nata (蛋塔)', time: '16:00' }
                ],
                '2026/02/13': [
                    { id: 701, category: '景點', name: '聖若熱城堡', time: '09:30' },
                    { id: 702, category: '美食', name: 'Uma Marisqueira (海鮮燉飯)', time: '19:30' }
                ],
                '2026/02/14': [
                    { id: 801, category: '美食', name: 'Casa Pastéis de Belém', time: '09:00' },
                    { id: 802, category: '景點', name: '貝倫塔', time: '15:30' }
                ],
                '2026/02/15': [
                    { id: 901, category: '交通', name: '抵達 波多聖本圖車站', time: '12:30', prevTransportIcon: 'train' },
                    { id: 902, category: '景點', name: '利貝拉碼頭', time: '17:00' },
                    { id: 903, category: '住宿', name: "Legends' House", time: '21:00' }
                ],
                '2026/02/16': [
                    { id: 1001, category: '景點', name: '萊羅書店', time: '09:30' },
                    { id: 1002, category: '景點', name: '路易一世大橋', time: '17:30' }
                ],
                '2026/02/17': [
                    { id: 1101, category: '景點', name: '波爾豪市場', time: '09:00' },
                    { id: 1102, category: '美食', name: 'Brasão Aliados', time: '18:30' }
                ]
            });

            const hotelList = [
                { name: 'ibis Paris Gare de Lyon', dateRange: '2/7 - 2/9', address: 'Paris' },
                { name: '尼斯公寓', dateRange: '2/9 - 2/12', address: 'Nice' },
                { name: 'The Visionaire Apartments', dateRange: '2/12 - 2/15', address: 'Lisbon' },
                { name: "Legends' House", dateRange: '2/15 - 2/17', address: 'Porto' }
            ];

            const currentCityDisplay = computed(() => {
                const date = selectedDate.value;
                if (date <= '2026/02/08') return '巴黎 Paris';
                if (date <= '2026/02/11') return '尼斯 Nice';
                if (date <= '2026/02/14') return '里斯本 Lisbon';
                return '波多 Porto';
            });

            const cityImage = computed(() => {
                const map = { 
                    '巴黎 Paris': 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?w=800', 
                    '尼斯 Nice': 'https://images.unsplash.com/photo-1533619239233-628ce632e948?w=800', 
                    '里斯本 Lisbon': 'https://images.unsplash.com/photo-1585208798174-6cedd862099b?w=800', 
                    '波多 Porto': 'https://images.unsplash.com/photo-1555881400-74d7acaacd8b?w=800' 
                };
                return map[currentCityDisplay.value] || map['巴黎 Paris'];
            });

            const getTabIcon = (t) => ({ itinerary: 'map-pin', info: 'info', shopping: 'shopping-basket', expense: 'circle-dollar-sign' }[t]);
            
            const catStyle = (c) => {
                const s = { '航班': 'bg-indigo-100 text-indigo-600', '景點': 'bg-emerald-100 text-emerald-600', '美食': 'bg-orange-100 text-orange-600', '住宿': 'bg-blue-100 text-blue-600' };
                return s[c] || 'bg-slate-100 text-slate-500';
            };

            const openGoogleMaps = (query) => {
                const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
                window.open(url, '_blank');
            };

            const addNewItem = () => {
                if (!newItemName.value) return;
                if (!itineraryData.value[selectedDate.value]) itineraryData.value[selectedDate.value] = [];
                itineraryData.value[selectedDate.value].push({ id: Date.now(), category: '其他', name: newItemName.value, time: '12:00' });
                newItemName.value = '';
                showAddModal.value = false;
            };

            onMounted(() => { lucide.createIcons(); });
            watch([activeTab, selectedDate, showAddModal], () => { nextTick(() => lucide.createIcons()); });

            return {
                activeTab, selectedDate, dates, itineraryData, hotelList, currentCityDisplay, cityImage, 
                eurInput, showAddModal, newItemName, getTabIcon, catStyle, openGoogleMaps, addNewItem
            };
        }
    });

    app.mount('#app');
</script>

</body>
</html>
