<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>橘子的 2026 歐洲冒險</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/4.1.0/vuedraggable.umd.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .glass-nav { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.4); }
        .tab-active { background-color: #000; color: #fff; }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="antialiased">

<div id="app" class="max-w-md mx-auto min-h-screen flex flex-col relative bg-slate-50 shadow-2xl overflow-hidden">
    
    <header class="relative h-64 flex-shrink-0 overflow-hidden">
        <img :src="cityImage" class="w-full h-full object-cover transition-all duration-700" alt="city">
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
        
        <div class="absolute bottom-16 left-6 text-white">
            <h1 class="text-3xl font-black">{{ currentCityDisplay }}</h1>
            <p class="text-sm opacity-80">Feb 2026 Trip Plan</p>
        </div>

        <div class="absolute bottom-4 right-4 left-4 flex justify-between glass-nav p-1 rounded-2xl shadow-xl">
            <button @click="activeTab = 'itinerary'" :class="['flex-1 flex justify-center py-3 rounded-xl transition-all', activeTab === 'itinerary' ? 'tab-active' : 'text-slate-500']">
                <i data-lucide="map-pin" class="w-5 h-5"></i>
            </button>
            <button @click="activeTab = 'info'" :class="['flex-1 flex justify-center py-3 rounded-xl transition-all', activeTab === 'info' ? 'tab-active' : 'text-slate-500']">
                <i data-lucide="info" class="w-5 h-5"></i>
            </button>
            <button @click="activeTab = 'shopping'" :class="['flex-1 flex justify-center py-3 rounded-xl transition-all', activeTab === 'shopping' ? 'tab-active' : 'text-slate-500']">
                <i data-lucide="shopping-basket" class="w-5 h-5"></i>
            </button>
            <button @click="activeTab = 'expense'" :class="['flex-1 flex justify-center py-3 rounded-xl transition-all', activeTab === 'expense' ? 'tab-active' : 'text-slate-500']">
                <i data-lucide="circle-dollar-sign" class="w-5 h-5"></i>
            </button>
        </div>
    </header>

    <main class="flex-1 -mt-6 bg-slate-50 rounded-t-[2.5rem] relative z-10 px-5 pt-8 pb-32 overflow-y-auto">
        
        <div v-if="activeTab === 'itinerary'" class="space-y-6">
            <div class="flex items-center justify-between bg-white p-4 rounded-3xl border border-slate-100 shadow-sm">
                <div class="flex items-center">
                    <i data-lucide="sun" class="w-8 h-8 text-yellow-500 mr-3"></i>
                    <div>
                        <div class="text-xl font-black">9°C</div>
                        <div class="text-[10px] text-slate-400 font-bold tracking-widest uppercase">Sunny · {{ currentCityDisplay }}</div>
                    </div>
                </div>
            </div>

            <div class="flex space-x-3 overflow-x-auto hide-scrollbar pb-2">
                <div v-for="d in dates" :key="d.full" 
                     @click="selectedDate = d.full"
                     :class="['flex-shrink-0 w-14 h-20 flex flex-col items-center justify-center rounded-2xl transition-all cursor-pointer', 
                              selectedDate === d.full ? 'bg-blue-600 text-white shadow-lg' : 'bg-white text-slate-400']">
                    <span class="text-[10px] font-bold mb-1">{{ d.weekday }}</span>
                    <span class="text-xl font-black">{{ d.day }}</span>
                </div>
            </div>

            <draggable v-model="itineraryData[selectedDate]" item-key="id" handle=".drag-handle">
                <template #item="{element, index}">
                    <div>
                        <div v-if="index > 0" class="flex items-center ml-10 my-3 text-slate-300">
                            <i :data-lucide="element.prevTransportIcon || 'walking'" class="w-4 h-4 mr-3"></i>
                            <span class="text-[10px] font-bold bg-slate-100 px-2 py-0.5 rounded-full">{{ element.travelTime || '15 min' }}</span>
                        </div>

                        <div @click="openGoogleMaps(element.name)" class="bg-white rounded-[1.5rem] p-4 shadow-sm border border-slate-100 flex items-start group active:bg-slate-50 transition-colors">
                            <div class="drag-handle p-2 -ml-2 cursor-grab text-slate-200 group-hover:text-slate-400">
                                <i data-lucide="grip-vertical" class="w-5 h-5"></i>
                            </div>
                            <div class="flex-1 ml-1">
                                <div class="flex justify-between items-center mb-1">
                                    <span :class="['text-[9px] px-2 py-0.5 rounded-lg font-black uppercase tracking-wider', catStyle(element.category)]">
                                        {{ element.category }}
                                    </span>
                                    <span class="text-slate-400 text-[10px] font-bold">{{ element.time }}</span>
                                </div>
                                <h3 class="font-bold text-slate-800">{{ element.name }}</h3>
                                <p v-if="element.remark" class="text-[11px] text-slate-400 mt-1">{{ element.remark }}</p>
                            </div>
                            <button @click.stop="deleteItem(selectedDate, index)" class="p-2 text-slate-200 hover:text-rose-500">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </template>
            </draggable>
        </div>

        <div v-if="activeTab === 'info'" class="space-y-6">
            <div class="bg-white p-6 rounded-[2rem] shadow-sm">
                <h3 class="font-black text-slate-800 mb-4 flex items-center">
                    <i data-lucide="refresh-cw" class="w-5 h-5 mr-2 text-blue-500"></i> 匯率換算 (EUR/TWD)
                </h3>
                <div class="space-y-3">
                    <input type="number" v-model="eurInput" class="w-full bg-slate-50 p-4 rounded-2xl font-black text-xl outline-none" placeholder="輸入歐元 EUR">
                    <div class="text-center text-blue-600 font-black text-2xl">
                        ≈ NT$ {{ (eurInput * 35.2).toLocaleString() }}
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-[2rem] shadow-sm">
                <h3 class="font-black text-slate-800 mb-4 flex items-center">
                    <i data-lucide="home" class="w-5 h-5 mr-2 text-emerald-500"></i> 住宿地點
                </h3>
                <div v-for="h in hotelList" :key="h.name" @click="openGoogleMaps(h.name)" class="mb-3 p-4 bg-slate-50 rounded-2xl border border-slate-100">
                    <div class="font-bold text-slate-800 text-sm">{{ h.name }}</div>
                    <div class="text-[10px] text-slate-400 mt-1">{{ h.address }}</div>
                </div>
            </div>
        </div>

        <div v-if="activeTab === 'shopping'" class="grid grid-cols-2 gap-4">
            <div v-for="item in shoppingList" :key="item.id" class="bg-white rounded-3xl overflow-hidden shadow-sm border border-slate-100">
                <div class="h-32 bg-slate-200 flex items-center justify-center text-slate-400">
                    <i data-lucide="image" class="w-8 h-8 opacity-20"></i>
                </div>
                <div class="p-3 text-sm font-bold text-slate-700">{{ item.name }}</div>
            </div>
        </div>

        <div v-if="activeTab === 'expense'" class="space-y-6">
            <div class="bg-slate-900 p-8 rounded-[2.5rem] text-white shadow-xl">
                <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Total Expenses</p>
                <div class="text-4xl font-black">€ {{ totalExpense.toFixed(1) }}</div>
            </div>
            <div class="space-y-3">
                <div v-for="exp in expenses" :key="exp.id" class="flex items-center justify-between bg-white p-4 rounded-2xl shadow-sm">
                    <div class="font-bold text-slate-800 text-sm">{{ exp.name }}</div>
                    <div class="font-black text-blue-600">€ {{ exp.amount }}</div>
                </div>
            </div>
        </div>

    </main>

    <button @click="showAddModal = true" class="fixed bottom-8 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center z-50 active:scale-90 transition-transform">
        <i data-lucide="plus" class="w-8 h-8"></i>
    </button>

    <div v-if="showAddModal" class="fixed inset-0 z-[100] flex items-end justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" @click="showAddModal = false"></div>
        <div class="bg-white w-full max-w-sm rounded-[2.5rem] p-8 relative shadow-2xl animate-in slide-in-from-bottom duration-300">
            <h3 class="text-2xl font-black mb-6">新增項目</h3>
            <input v-model="newItem.name" type="text" placeholder="名稱" class="w-full bg-slate-50 p-4 rounded-2xl mb-4 outline-none border-2 border-transparent focus:border-blue-500">
            <button @click="addItem" class="w-full py-4 bg-blue-600 text-white rounded-2xl font-black text-lg">確認新增</button>
        </div>
    </div>

</div>

<script>
    const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;

    createApp({
        components: {
            draggable: window.vuedraggable
        },
        setup() {
            const activeTab = ref('itinerary');
            const selectedDate = ref('2026/02/07');
            const eurInput = ref(0);
            const showAddModal = ref(false);
            const newItem = ref({ name: '', category: '景點' });

            const dates = [
                { day: '07', weekday: 'Sat', full: '2026/02/07' },
                { day: '08', weekday: 'Sun', full: '2026/02/08' },
                { day: '09', weekday: 'Mon', full: '2026/02/09' },
                { day: '10', weekday: 'Tue', full: '2026/02/10' },
                { day: '11', weekday: 'Wed', full: '2026/02/11' },
                { day: '12', weekday: 'Thu', full: '2026/02/12' },
                { day: '13', weekday: 'Fri', full: '2026/02/13' },
                { day: '14', weekday: 'Sat', full: '2026/02/14' },
                { day: '15', weekday: 'Sun', full: '2026/02/15' },
                { day: '16', weekday: 'Mon', full: '2026/02/16' },
                { day: '17', weekday: 'Tue', full: '2026/02/17' }
            ];

            const itineraryData = ref({
                '2026/02/07': [
                    { id: 101, category: '航班', name: '巴黎戴高樂機場 (CDG)', time: '10:30', remark: '抵達巴黎', travelTime: '45 min', prevTransportIcon: 'bus' },
                    { id: 102, category: '住宿', name: 'ibis Paris Gare de Lyon Diderot', time: '14:00', remark: 'Check-in', travelTime: '15 min', prevTransportIcon: 'walking' },
                    { id: 103, category: '美食', name: "La Maison d'Isabelle", time: '15:30', remark: '可頌', travelTime: '20 min', prevTransportIcon: 'walking' },
                    { id: 104, category: '購物', name: '樂蓬馬歇百貨公司', time: '16:30', travelTime: '15 min', prevTransportIcon: 'walking' },
                    { id: 105, category: '美食', name: 'Breizh Café', time: '18:30' },
                    { id: 106, category: '景點', name: '巴黎聖母院', time: '20:00' }
                ],
                '2026/02/08': [
                    { id: 201, category: '美食', name: 'Jellycat Pâtisserie', time: '10:00' },
                    { id: 202, category: '美食', name: 'Bachir 冰淇淋', time: '14:00' },
                    { id: 203, category: '美食', name: 'Papy aux Fourneaux', time: '19:00' }
                ],
                '2026/02/09': [
                    { id: 301, category: '航班', name: '巴黎 ➔ 尼斯', time: '09:00', prevTransportIcon: 'plane' },
                    { id: 302, category: '住宿', name: '5 Rue Gustave Deloye (尼斯公寓)', time: '12:00' },
                    { id: 303, category: '美食', name: 'Maison Margaux', time: '14:00' },
                    { id: 304, category: '景點', name: '馬塞納廣場', time: '16:00' },
                    { id: 305, category: '美食', name: 'Gusti Restaurant', time: '19:00' }
                ],
                '2026/02/10': [
                    { id: 401, category: '景點', name: '城堡山公園', time: '09:30' },
                    { id: 402, category: '景點', name: '賽雷亞花果市集', time: '11:00' },
                    { id: 403, category: '美食', name: 'Peixes', time: '13:00' },
                    { id: 404, category: '景點', name: '尼斯老城區', time: '15:00' }
                ],
                '2026/02/11': [
                    { id: 501, category: '景點', name: '埃茲小鎮 Èze Village', time: '10:00', prevTransportIcon: 'bus' },
                    { id: 502, category: '景點', name: '摩納哥親王宮', time: '15:00', prevTransportIcon: 'bus' }
                ],
                '2026/02/12': [
                    { id: 601, category: '航班', name: '尼斯 ➔ 里斯本', time: '11:00', prevTransportIcon: 'plane' },
                    { id: 602, category: '住宿', name: 'The Visionaire Apartments', time: '15:00' },
                    { id: 603, category: '美食', name: 'Fábrica da Nata', time: '16:00' },
                    { id: 604, category: '景點', name: '奧古斯塔街拱門', time: '17:30' },
                    { id: 605, category: '美食', name: 'Nova Wine Bar', time: '19:30' },
                    { id: 606, category: '景點', name: '聖胡斯塔升降機', time: '21:30' }
                ],
                '2026/02/13': [
                    { id: 701, category: '景點', name: '聖若熱城堡', time: '09:30' },
                    { id: 702, category: '美食', name: 'Café da Garagem', time: '12:00' },
                    { id: 703, category: '景點', name: '恩寵觀景台', time: '14:30' },
                    { id: 704, category: '美食', name: 'Uma Marisqueira', time: '19:30' }
                ],
                '2026/02/14': [
                    { id: 801, category: '美食', name: 'Casa Pastéis de Belém', time: '09:00', prevTransportIcon: 'bus' },
                    { id: 802, category: '景點', name: '熱羅尼莫斯修道院', time: '11:00' },
                    { id: 803, category: '景點', name: '貝倫塔', time: '15:30' }
                ],
                '2026/02/15': [
                    { id: 901, category: '交通', name: '抵達 波多聖本圖車站', time: '12:30', prevTransportIcon: 'train' },
                    { id: 902, category: '景點', name: '波爾圖主教座堂', time: '14:00' },
                    { id: 903, category: '景點', name: '利貝拉碼頭', time: '17:00' },
                    { id: 904, category: '住宿', name: "Legends' House", time: '21:00' }
                ],
                '2026/02/16': [
                    { id: 1001, category: '景點', name: '萊羅書店', time: '09:30' },
                    { id: 1002, category: '景點', name: '教士塔', time: '11:30' },
                    { id: 1003, category: '美食', name: 'Conga 豬扒包', time: '16:00' },
                    { id: 1004, category: '景點', name: '路易一世大橋', time: '17:30' },
                    { id: 1005, category: '景點', name: '莫羅花園日落', time: '19:30' }
                ],
                '2026/02/17': [
                    { id: 1101, category: '景點', name: '波爾豪市場', time: '09:00' },
                    { id: 1102, category: '美食', name: 'Cachorrinho Gazela', time: '13:00' },
                    { id: 1103, category: '美食', name: 'Brasão Aliados', time: '18:30' }
                ]
            });

            const hotelList = [
                { name: 'ibis Paris Gare de Lyon Diderot', address: 'Paris, France' },
                { name: '尼斯公寓', address: '5 Rue Gustave Deloye, Nice' },
                { name: 'The Visionaire Apartments', address: 'Lisbon, Portugal' },
                { name: "Legends' House", address: 'Porto, Portugal' }
            ];

            const shoppingList = ref([{ id: 1, name: 'Longchamp 包包' }, { id: 2, name: '藥妝' }]);
            const expenses = ref([{ id: 1, name: '午餐', amount: 25.5 }]);

            const currentCityDisplay = computed(() => {
                const date = selectedDate.value;
                if (date <= '2026/02/08') return '巴黎 Paris';
                if (date <= '2026/02/11') return '尼斯 Nice';
                if (date <= '2026/02/14') return '里斯本 Lisbon';
                return '波多 Porto';
            });

            const cityImage = computed(() => {
                const map = { '巴黎 Paris': 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?w=800', '尼斯 Nice': 'https://images.unsplash.com/photo-1533619239233-628ce632e948?w=800', '里斯本 Lisbon': 'https://images.unsplash.com/photo-1585208798174-6cedd862099b?w=800', '波多 Porto': 'https://images.unsplash.com/photo-1555881400-74d7acaacd8b?w=800' };
                return map[currentCityDisplay.value];
            });

            const totalExpense = computed(() => expenses.value.reduce((sum, e) => sum + e.amount, 0));

            const addItem = () => {
                if (!newItem.value.name) return;
                itineraryData.value[selectedDate.value].push({ id: Date.now(), ...newItem.value, time: '12:00' });
                newItem.value = { name: '', category: '景點' };
                showAddModal.value = false;
            };

            const deleteItem = (date, idx) => {
                if (confirm('確定刪除？')) itineraryData.value[date].splice(idx, 1);
            };

            const openGoogleMaps = (q) => {
                const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(q)}`;
                window.open(url, '_blank');
            };

            const catStyle = (c) => {
                const s = { '航班': 'bg-indigo-100 text-indigo-600', '景點': 'bg-emerald-100 text-emerald-600', '美食': 'bg-orange-100 text-orange-600', '住宿': 'bg-blue-100 text-blue-600' };
                return s[c] || 'bg-slate-100 text-slate-500';
            };

            onMounted(() => lucide.createIcons());
            watch([activeTab, selectedDate, showAddModal], () => nextTick(() => lucide.createIcons()));

            return {
                activeTab, selectedDate, dates, itineraryData, hotelList, shoppingList, expenses,
                currentCityDisplay, cityImage, totalExpense, eurInput, showAddModal, newItem,
                addItem, deleteItem, openGoogleMaps, catStyle
            };
        }
    }).mount('#app');
</script>

</body>
</html>
